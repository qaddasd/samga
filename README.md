## samga.nis

Проект на Next.js 14 (TypeScript) с Tailwind CSS и современным UI. Содержит экран входа с технологичным фоном (градиенты, точки, «орбы») и панель преимуществ. Реализованы устойчивое хранение токенов, корректный выход из аккаунта и переключение темы (светлая/тёмная).

### Быстрый старт
- Требования: Node.js 18+ и npm 9+
- Установка зависимостей:
```bash
npm install
```
- Запуск dev-сервера (как изначально требуется):
```bash
npm run dev
```
Откройте `http://localhost:3000` (если порт занят, Next.js автоматически переключится, например, на `3001`).

- Сборка и запуск production-сервера:
```bash
npm run build
npm start
```

- Линтинг и авто‑починка:
```bash
npm run lint
npm run lint:fix
```

Примечание: в `package.json` указан менеджер `pnpm`, но проект полностью работает через `npm`. Если предпочитаете `pnpm`, используйте `pnpm i` и `pnpm dev`.

### Структура
- `src/app/layout.tsx` — корневой лайаут, провайдеры, глобальные стили
- `src/app/login/page.tsx` — правая панель логина (форма), фоновые эффекты и переключатель темы
- `src/widgets/login/AuthForm.tsx` — форма авторизации (ИИН/пароль), эффекты успешного входа
- `src/widgets/login/BenefitsPanel.tsx` — левая панель с карточками преимуществ и фоном
- `src/app/globals.scss` — Tailwind и глобальные анимации (искры, орбы, туман)
- `public/benefits.jpg` — фон для панели преимуществ

### UI и эффекты
- Точечный паттерн (dot grid) отображается и в светлой, и в тёмной теме.
- Мягкие сине‑голубые градиенты и «орбы» (свечения) создают технологичный фон.
- Разделение между панелями — туманная дымка без резкой линии; в светлой теме используется голубая дымка, в тёмной — тёмная.
- Переключатель темы (солнце/луна) отображается в правом верхнем углу формы логина.
- Производительность: при системной настройке “prefers‑reduced‑motion: reduce” искры и орбы отключаются автоматически.

### Аутентификация
- `src/app/page.tsx` — серверный редирект: если есть cookie `Access`, перенаправляет на `/dash`, иначе на `/login`.
- `src/server/actions/login.ts` → `src/lib/token/issuer.ts` — выставление cookie `Access` и `Refresh` (в dev `secure=false` для стабильности на localhost). После успешного входа форма дублирует токены в `localStorage` и ставит `isLoggedIn=true`.
- `src/lib/providers/QueryProvider.tsx` — периодическая проверка и продление токена; учитывает флаг `samga-logout-flag` (исключает авто‑логин после явного выхода).
- Выход из аккаунта:
  - `src/components/Logout.tsx` — чистит `localStorage`, ставит `samga-logout-flag` и вызывает API.
  - `src/app/api/logout/route.ts` — удаляет cookie `Access`/`Refresh`.

### Мобильные сборки (опционально)
Скрипты для Capacitor уже добавлены:
```bash
# подготовка статического экспорта
npm run static-export

# синхронизация и сборка Android (пример)
npm run capacitor:sync
npm run capacitor:add:android
npm run capacitor:open:android
```
При необходимости отредактируйте команды под вашу среду.

### Частые вопросы
- «Пятно» в светлой теме: границы панелей сделаны туманными; в светлой теме используется голубая дымка + лёгкий blur, чтобы не было чёрных артефактов.
- Порт 3000 занят: Next.js автоматически выберет свободный порт (например, 3001) и выведет его в консоль.
- Старые устройства: тяжёлые эффекты сведены к минимуму; при `prefers‑reduced‑motion: reduce` динамика отключается.

### Лицензия
Не указана. Если требуется, добавьте выбранную лицензию в `LICENSE`. 